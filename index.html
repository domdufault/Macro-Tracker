<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0b0d12" />
  <title>Dom’s Daily Macros</title>

  <style>
    :root{
      --bg0:#0b0d12;
      --bg1:#10131a;
      --card: rgba(23,26,33,0.88);
      --border: rgba(255,255,255,0.08);
      --shadow: rgba(0,0,0,0.25);
      --text:#e9ecf1;
      --muted:#aab2c0;
      --ringTrack:#2a2f3a;

      --calColor:#ffb703;
      --proColor:#7ee081;
      --fatColor:#4dabff;
      --fibColor:#b08cff;

      --dangerBg:#2a1420;
      --btnBg:#202535;
      --btnMuted:#141824;

      --circ:289.02652413026095;
    }

    body.light{
      --bg0:#f5f7fb;
      --bg1:#e9eef8;
      --card: rgba(255,255,255,0.92);
      --border: rgba(10,18,32,0.10);
      --shadow: rgba(10,18,32,0.12);
      --text:#0c1220;
      --muted:#465063;
      --ringTrack:#d7deeb;
      --dangerBg:#ffe7ee;
      --btnBg:#0f172a;
      --btnMuted:#e9eef8;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      background:linear-gradient(180deg,var(--bg0), var(--bg1));
      color:var(--text);
    }

    .wrap{max-width:980px;margin:0 auto;padding:18px}

    .title{
      font-size:36px;
      font-weight:900;
      letter-spacing:-0.02em;
      margin-bottom:16px;
    }

    .tabs{
      display:flex;
      gap:10px;
      margin-bottom:14px;
    }

    .tab{
      flex:1;
      padding:10px;
      border-radius:12px;
      border:1px solid var(--border);
      background:rgba(0,0,0,0.2);
      color:var(--text);
      font-weight:800;
      cursor:pointer;
    }

    .tab.active{
      background:var(--btnBg);
    }

    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:18px;
      padding:14px;
      box-shadow:0 10px 30px var(--shadow);
      margin-bottom:12px;
    }

    .rings{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:12px;
    }

    .ringCard{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:8px;
      padding:14px;
      background:rgba(0,0,0,0.15);
      border-radius:16px;
      border:1px solid var(--border);
    }

    .ringLabel{font-weight:900;font-size:18px}

    .ring{
      width:118px;height:118px;position:relative;
    }

    .ring svg{width:118px;height:118px;transform:rotate(-90deg)}

    .center{
      position:absolute;
      inset:0;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
    }

    .big{font-size:22px;font-weight:900}
    .small{font-size:12px;color:var(--muted)}

    .track{stroke:var(--ringTrack);stroke-width:10;fill:none}
    .prog{stroke-width:10;fill:none;stroke-linecap:round;stroke-dasharray:var(--circ);stroke-dashoffset:var(--circ)}

    .ringNums{font-size:13px;color:var(--muted)}

    .formRow{
      display:grid;
      grid-template-columns:repeat(4,1fr);
      gap:10px;
      margin-top:10px;
    }

    input{
      padding:11px;
      border-radius:12px;
      border:1px solid var(--border);
      background:rgba(0,0,0,0.2);
      color:var(--text);
    }

    .btnRow{
      display:flex;
      gap:10px;
      margin-top:10px;
    }

    button{
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--border);
      background:var(--btnBg);
      color:#fff;
      font-weight:800;
      cursor:pointer;
    }

    .danger{background:var(--dangerBg);color:var(--text)}

    .log{
      display:flex;
      flex-direction:column;
      gap:8px;
      max-height:400px;
      overflow:auto;
    }

    .entry{
      display:grid;
      grid-template-columns:1fr auto;
      gap:10px;
      padding:10px;
      border-radius:12px;
      border:1px solid var(--border);
      background:rgba(0,0,0,0.15);
    }

    .delBtn{
      background:rgba(255,255,255,0.1);
      border-radius:10px;
      padding:6px 10px;
      border:1px solid var(--border);
      font-weight:900;
      cursor:pointer;
    }

    .settingsRow{
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .switch{
      width:54px;height:32px;
      border-radius:999px;
      background:rgba(255,255,255,0.1);
      border:1px solid var(--border);
      position:relative;
      cursor:pointer;
    }

    .knob{
      width:26px;height:26px;
      border-radius:999px;
      background:#fff;
      position:absolute;
      top:3px;left:3px;
      transition:0.2s;
    }

    .switch.on .knob{transform:translateX(22px)}
  </style>
</head>

<body>
  <div class="wrap">

    <div class="title">Dom’s Daily Macros</div>

    <div class="tabs">
      <button class="tab active" id="tabMain">Tracker</button>
      <button class="tab" id="tabSettings">Settings</button>
    </div>

    <!-- MAIN TRACKER -->
    <div id="mainView">

      <div class="card">
        <div class="rings">
          <div class="ringCard">
            <div class="ringLabel">Calories</div>
            <div class="ring">
              <svg viewBox="0 0 120 120">
                <circle class="track" cx="60" cy="60" r="46"/>
                <circle class="prog" id="ringCal" cx="60" cy="60" r="46"/>
              </svg>
              <div class="center">
                <div class="big" id="calNow">0</div>
                <div class="small">/ <span id="calGoal">2000</span></div>
              </div>
            </div>
            <div class="ringNums"><span id="calRem">2000</span> remaining</div>
          </div>

          <div class="ringCard">
            <div class="ringLabel">Protein</div>
            <div class="ring">
              <svg viewBox="0 0 120 120">
                <circle class="track" cx="60" cy="60" r="46"/>
                <circle class="prog" id="ringPro" cx="60" cy="60" r="46"/>
              </svg>
              <div class="center">
                <div class="big" id="proNow">0</div>
                <div class="small">/ <span id="proGoal">120</span> g</div>
              </div>
            </div>
            <div class="ringNums"><span id="proRem">120</span> g needed</div>
          </div>

          <div class="ringCard">
            <div class="ringLabel">Fat</div>
            <div class="ring">
              <svg viewBox="0 0 120 120">
                <circle class="track" cx="60" cy="60" r="46"/>
                <circle class="prog" id="ringFat" cx="60" cy="60" r="46"/>
              </svg>
              <div class="center">
                <div class="big" id="fatNow">0</div>
                <div class="small">/ <span id="fatGoal">60</span> g</div>
              </div>
            </div>
            <div class="ringNums"><span id="fatRem">60</span> g needed</div>
          </div>

          <div class="ringCard">
            <div class="ringLabel">Fiber</div>
            <div class="ring">
              <svg viewBox="0 0 120 120">
                <circle class="track" cx="60" cy="60" r="46"/>
                <circle class="prog" id="ringFib" cx="60" cy="60" r="46"/>
              </svg>
              <div class="center">
                <div class="big" id="fibNow">0</div>
                <div class="small">/ <span id="fibGoal">30</span> g</div>
              </div>
            </div>
            <div class="ringNums"><span id="fibRem">30</span> g needed</div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="formRow">
          <input id="inCal" placeholder="Calories">
          <input id="inPro" placeholder="Protein (g)">
          <input id="inFat" placeholder="Fat (g)">
          <input id="inFib" placeholder="Fiber (g)">
        </div>
        <div class="btnRow">
          <button id="addBtn">Add Entry</button>
        </div>
      </div>

      <div class="card">
        <h3>Today’s Log</h3>
        <div class="log" id="log"></div>
      </div>

    </div>

    <!-- SETTINGS -->
    <div id="settingsView" style="display:none;">

      <div class="card settingsRow">
        <h3>Appearance</h3>
        <div class="switch" id="themeSwitch"><div class="knob"></div></div>
      </div>

      <div class="card settingsRow">
        <h3>Goals</h3>
        <input id="setCal" placeholder="Calories goal">
        <input id="setPro" placeholder="Protein goal">
        <input id="setFat" placeholder="Fat goal">
        <input id="setFib" placeholder="Fiber goal">
        <button id="saveGoals">Save Goals</button>
      </div>

      <div class="card settingsRow">
        <h3>Reset</h3>
        <button class="danger" id="resetBtn">Reset Day</button>
      </div>

    </div>

  </div>

<script>
(() => {
  const KEY = "dom_macros_v3";
  const THEME = "dom_theme";

  let goals = { cal:2000, pro:120, fat:60, fib:30 };

  let state = { totals:{cal:0,pro:0,fat:0,fib:0}, log:[] };

  const $ = id => document.getElementById(id);

  function save(){
    localStorage.setItem(KEY, JSON.stringify({goals, state}));
  }

  function load(){
    const raw = localStorage.getItem(KEY);
    if(raw){
      const data = JSON.parse(raw);
      goals = data.goals;
      state = data.state;
    }
  }

  function setRing(el, value, goal, color){
    const pct = Math.min(value/goal,1);
    const dash = 289;
    el.style.strokeDashoffset = dash * (1 - pct);
    el.style.stroke = color;
  }

  function render(){
    $("calNow").textContent = state.totals.cal;
    $("proNow").textContent = state.totals.pro;
    $("fatNow").textContent = state.totals.fat;
    $("fibNow").textContent = state.totals.fib;

    $("calGoal").textContent = goals.cal;
    $("proGoal").textContent = goals.pro;
    $("fatGoal").textContent = goals.fat;
    $("fibGoal").textContent = goals.fib;

    $("calRem").textContent = Math.max(0, goals.cal - state.totals.cal);
    $("proRem").textContent = Math.max(0, goals.pro - state.totals.pro);
    $("fatRem").textContent = Math.max(0, goals.fat - state.totals.fat);
    $("fibRem").textContent = Math.max(0, goals.fib - state.totals.fib);

    setRing($("ringCal"), state.totals.cal, goals.cal, "#ffb703");
    setRing($("ringPro"), state.totals.pro, goals.pro, "#7ee081");
    setRing($("ringFat"), state.totals.fat, goals.fat, "#4dabff");
    setRing($("ringFib"), state.totals.fib, goals.fib, "#b08cff");

    $("log").innerHTML = "";
    state.log.slice().reverse().forEach((e,i)=>{
      const row = document.createElement("div");
      row.className="entry";
      row.innerHTML = `
        <div>${e.cal} cal • ${e.pro}P • ${e.fat}F • ${e.fib} fiber</div>
        <button class="delBtn">✕</button>
      `;
      row.querySelector("button").onclick=()=>{
        state.log.splice(state.log.length-1-i,1);
        recalc(); save(); render();
      };
      $("log").appendChild(row);
    });
  }

  function recalc(){
    state.totals = {cal:0,pro:0,fat:0,fib:0};
    state.log.forEach(e=>{
      state.totals.cal+=e.cal;
      state.totals.pro+=e.pro;
      state.totals.fat+=e.fat;
      state.totals.fib+=e.fib;
    });
  }

  $("addBtn").onclick=()=>{
    const e={
      cal:+$("inCal").value||0,
      pro:+$("inPro").value||0,
      fat:+$("inFat").value||0,
      fib:+$("inFib").value||0
    };
    if(!e.cal&&!e.pro&&!e.fat&&!e.fib) return;
    state.log.push(e);
    recalc(); save(); render();
    ["inCal","inPro","inFat","inFib"].forEach(id=>$(id).value="");
  };

  $("resetBtn").onclick=()=>{
    if(confirm("Reset the day?")){
      state={totals:{cal:0,pro:0,fat:0,fib:0},log:[]};
      save(); render();
    }
  };

  $("saveGoals").onclick=()=>{
    goals={
      cal:+$("setCal").value||goals.cal,
      pro:+$("setPro").value||goals.pro,
      fat:+$("setFat").value||goals.fat,
      fib:+$("setFib").value||goals.fib
    };
    save(); render();
    alert("Goals updated!");
  };

  $("tabMain").onclick=()=>{
    $("mainView").style.display="block";
    $("settingsView").style.display="none";
    $("tabMain").classList.add("active");
    $("tabSettings").classList.remove("active");
  };

  $("tabSettings").onclick=()=>{
    $("mainView").style.display="none";
    $("settingsView").style.display="block";
    $("tabSettings").classList.add("active");
    $("tabMain").classList.remove("active");
  };

  $("themeSwitch").onclick=()=>{
    document.body.classList.toggle("light");
    localStorage.setItem(THEME, document.body.classList.contains("light")?"light":"dark");
  };

  if(localStorage.getItem(THEME)==="light") document.body.classList.add("light");

  load(); render();
})();
</script>
</body>
</html>